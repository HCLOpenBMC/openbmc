From 7b7a18c3282de444dbf35bf50a3f9cc7bb704be1 Mon Sep 17 00:00:00 2001
From: HCLOpenBMC <HCL_OpenBMC@hcl.com>
Date: Tue, 5 May 2020 10:23:29 +0530
Subject: [PATCH] systemd: reformat PACKAGECONFIG for easier comparison

---
 16c673d.diff                                       | 39 ++++++++++++++++++++++
 .../recipes-core/systemd/systemd_%.bbappend        | 16 +++++++--
 .../recipes-core/systemd/systemd_%.bbappend.orig   |  6 ----
 3 files changed, 53 insertions(+), 8 deletions(-)
 create mode 100644 16c673d.diff

diff --git a/16c673d.diff b/16c673d.diff
new file mode 100644
index 0000000..5cb0150
--- /dev/null
+++ b/16c673d.diff
@@ -0,0 +1,39 @@
+From 16c673d2ce6c32a70fb0080f5e6d05246935dd4b Mon Sep 17 00:00:00 2001
+From: Patrick Williams <patrick@stwcx.xyz>
+Date: Sat, 02 May 2020 06:31:39 -0500
+Subject: [PATCH] systemd: reformat PACKAGECONFIG for easier comparison
+
+Break each PACKAGECONFIG variable into their own line and sort to
+allow easier comparison with meta-poky's systemd_%.bb files.
+
+Signed-off-by: Patrick Williams <patrick@stwcx.xyz>
+Change-Id: I3b20bb5e8a1fa5196c1996caf4dcf025a33a289b
+---
+
+diff --git a/recipes-core/systemd/systemd_%.bbappend b/recipes-core/systemd/systemd_%.bbappend
+index 16ba8f7..312b583 100644
+--- a/recipes-core/systemd/systemd_%.bbappend
++++ b/recipes-core/systemd/systemd_%.bbappend
+@@ -1,8 +1,20 @@
+ FILES_${PN}-catalog-extralocales = \
+             "${exec_prefix}/lib/systemd/catalog/*.*.catalog"
+ PACKAGES =+ "${PN}-catalog-extralocales"
+-PACKAGECONFIG = "pam hostnamed networkd randomseed resolved sysusers timedated \
+-                 timesyncd xz kmod coredump"
++
++PACKAGECONFIG = " \
++        coredump \
++        hostnamed \
++        kmod \
++        networkd \
++        pam \
++        randomseed \
++        resolved \
++        sysusers \
++        timedated \
++        timesyncd \
++        xz \
++        "
+ 
+ FILESEXTRAPATHS_prepend := "${THISDIR}/${PN}:"
+ SRC_URI += "file://default.network"
diff --git a/meta-phosphor/recipes-core/systemd/systemd_%.bbappend b/meta-phosphor/recipes-core/systemd/systemd_%.bbappend
index 22e50c3..04e07a2 100644
--- a/meta-phosphor/recipes-core/systemd/systemd_%.bbappend
+++ b/meta-phosphor/recipes-core/systemd/systemd_%.bbappend
@@ -1,8 +1,20 @@
 FILES_${PN}-catalog-extralocales = \
             "${exec_prefix}/lib/systemd/catalog/*.*.catalog"
 PACKAGES =+ "${PN}-catalog-extralocales"
-PACKAGECONFIG = "pam hostnamed networkd randomseed resolved sysusers timedated \
-                 timesyncd xz kmod coredump"
+
+PACKAGECONFIG = " \
+        coredump \
+        hostnamed \
+        kmod \
+        networkd \
+        pam \
+        randomseed \
+        resolved \
+        sysusers \
+        timedated \
+        timesyncd \
+        xz \
+        "
 
 FILESEXTRAPATHS_prepend := "${THISDIR}/${PN}:"
 SRC_URI += "file://0001-sd-bus-Don-t-automatically-add-ObjectManager.patch"
diff --git a/meta-phosphor/recipes-core/systemd/systemd_%.bbappend.orig b/meta-phosphor/recipes-core/systemd/systemd_%.bbappend.orig
index 16ba8f7..22e50c3 100644
--- a/meta-phosphor/recipes-core/systemd/systemd_%.bbappend.orig
+++ b/meta-phosphor/recipes-core/systemd/systemd_%.bbappend.orig
@@ -5,16 +5,10 @@ PACKAGECONFIG = "pam hostnamed networkd randomseed resolved sysusers timedated \
                  timesyncd xz kmod coredump"
 
 FILESEXTRAPATHS_prepend := "${THISDIR}/${PN}:"
-SRC_URI += "file://default.network"
 SRC_URI += "file://0001-sd-bus-Don-t-automatically-add-ObjectManager.patch"
 
-FILES_${PN} += "${systemd_unitdir}/network/default.network"
 EXTRA_OEMESON += "-Ddns-servers=''"
 
-do_install_append() {
-        install -m 644 ${WORKDIR}/default.network ${D}${systemd_unitdir}/network/
-}
-
 ALTERNATIVE_${PN} += "init"
 ALTERNATIVE_TARGET[init] = "${rootlibexecdir}/systemd/systemd"
 ALTERNATIVE_LINK_NAME[init] = "${base_sbindir}/init"
-- 
2.7.4

